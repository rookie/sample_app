/*    HTTP Host:  b.static.ak.fbcdn.net                                        */
/*    Generated:  February 17th 2010 3:03:13 PM PST                            */
/*      Machine:  10.16.139.109                                                */
/*       Source:  Global Cache                                                 */
/*     Location:  js/aw0s0mjm7jksksg0.pkg.js h:13wwl22f                        */
/*       Locale:  nu_ll                                                        */
/*         Path:  js/aw0s0mjm7jksksg0.pkg.js                                   */

((location=='about:blank'&&(window.parent.eval_global||window.parent.eval))||(window.eval_global||window.eval))("if (window.CavalryLogger) { CavalryLogger.start_js([\"js\\\/aw0s0mjm7jksksg0.pkg.js\"]); }\n\nfunction survey_show_dialog(c,b){var a=bagofholding;if(b)a=goURI.curry(b,true);survey_show_dialog_callback(c,a);}function survey_show_dialog_callback(d,b,c){var a=new AsyncRequest().setMethod('GET').setData({survey_id:d,required:c}).setReadOnly(true).setURI('\/ajax\/survey.php');new Dialog().setAsync(a).setCloseHandler(b).show();}function survey_clear_radio(c){var d=DOM.scry($('survey_dialog'),'input.inputradio');var b=d.length;if(b>0)for(var a=0;a<b;++a)if(d[a].checked&&d[a].id!=c){d[a].checked=false;}else if(d[a].id==c)d[a].checked=true;}\nfunction uitos_show_email_dropdown(){CSS.removeClass($('grant_email_type'),'hidden_elem');CSS.addClass($('email_description'),'hidden_elem');}function uitos_is_disabled(){var b=ge('confirm_button');if(b){var a=DOM.find(b,'a.UIActionButton');return (CSS.hasClass(a,'UIButton_Disabled'));}}function uitos_form_submit(b,d){if(uitos_is_disabled())return false;if(d){var c=d.all||d[$('grant_email_type').value];survey_show_dialog_callback(c,uitos_form_submit.curry(b),true);}else{var a=$(b);a.submit();}}\n_PERSISTENT_BACKENDS={localstorage:LocalStorage};function LocalStorage(){this._store=window.localStorage;}LocalStorage.available=function(){return window.localStorage?true:false;};copy_properties(LocalStorage.prototype,{keys:function(){var b=[];for(var a=0;a<this._store.length;a++)b.push(this._store.key(a));return b;},get:function(a){return this._store.getItem(a);},set:function(a,b){this._store.setItem(a,b);},remove:function(a){this._store.removeItem(a);},clear:function(){this._store.clear();}});function CacheStorage(d,b){this._key_prefix=b||'_cs_';this._magic_prefix='_@_';if(d=='AUTO')for(var c in _PERSISTENT_BACKENDS){var a=_PERSISTENT_BACKENDS[c];if(a.available()){d=c;break;}}if(d)if(!_PERSISTENT_BACKENDS[d]){this._backend=null;}else this._backend=new _PERSISTENT_BACKENDS[d]();this._memcache={};}copy_properties(CacheStorage.prototype,{keys:function(){var d=[];if(this._backend){var a=this._backend.keys();for(var b=0;b<a.length;b++)if(a[b].substr(0,this._key_prefix.length)==this._key_prefix)d.push(a[b].substr(this._key_prefix.length));return d;}for(var c in this._memcache)d.push(c);return d;},set:function(b,a){this._memcache[b]=a;if(this._backend){if(typeof a=='string'){a=this._magic_prefix+a;}else a=JSON.encode(a);this._backend.set(this._key_prefix+b,a);}},get:function(b,c){if(this._memcache[b]!==undefined)return this._memcache[b];var d=undefined;if(this._backend){var d=this._backend.get(this._key_prefix+b);if(d!==null){if(d.substr(0,this._magic_prefix.length)==this._magic_prefix){d=d.substr(this._magic_prefix.length);}else d=JSON.decode(d);this._memcache[b]=d;}else d=undefined;}if(d===undefined&&c!==undefined){d=c;this._memcache[b]=d;if(this._backend){if(typeof d=='string'){var a=this._magic_prefix+d;}else var a=JSON.encode(d);this._backend.set(this._key_prefix+b,a);}}return d;},remove:function(a){delete this._memcache[a];if(this._backend)this._backend.remove(this._key_prefix+a);}});\nvar Configurable={getOption:function(a){if(typeof(this.option[a])=='undefined')return null;return this.option[a];},setOption:function(a,b){if(!(typeof(this.option[a])=='undefined'))this.option[a]=b;return this;},getOptions:function(){return this.option;}};\nfunction Nectar(){}copy_properties(Nectar,{linkHandler:function(c,a){var b=Nectar.getNectarParams();b.ia=1;var e=a.href;if(!e){e=URI.getRequestURI().toString();b.err=1;}b.url=e;var d='\/ajax\/nectar.php'+'?'+URI.implodeQuery({nctr:b})+'&';new AsyncSignal(d,{}).send();return c;},getNectarParams:function(){var c={};var a=env_get('nctrlid');if(a)c.id=a;var b=env_get('nctrlnid');if(b)c.nid=b;if(a||b)c.ct=(new Date()).getTime();copy_properties(c,Nectar.extraData.get_query_data());return c;},extraData:function(){var a={};var b=[];return {set_item:function(c,e,d){var f=a[c];if(f===undefined){if(d)b.push(c);f=[];a[c]=f;}return f.push(e);},get_item:function(c){return a[c]||[];},get_query_data:function(){var c,f,d,e={};for(c=0;c<b.length;c++){d=b[c];f=a[d];if(f)e[d]=f.join(',');}a=[];b=[];return e;}};}()});\nfunction NectarPhotosLog(){}copy_properties(NectarPhotosLog,{PHOTOS_BUF_LEN:20,showPhotoHandler:function(g,b){var e,c,a,f;c=b.node;e=b.pid;a=b.aid;f=b.ss;var d=Nectar.extraData.get_item('pts');if(e!==undefined){if(d.length==0){Nectar.extraData.set_item('url',c.href,false);Nectar.extraData.set_item('aid',a,true);Nectar.extraData.set_item('ss',f,false);}Nectar.extraData.set_item('pts',e,true);}d=Nectar.extraData.get_item('pts');if(d.length>=NectarPhotosLog.PHOTOS_BUF_LEN)NectarPhotosLog.flushLog();return false;},flushLog:function(){var a=Nectar.extraData.get_item('pts');if(a.length>0){var b=Nectar.extraData.get_item('url')[0];Nectar.linkHandler(false,{href:b});}return false;}});onloadRegister(function(){Arbiter.subscribe(PhotostreamConstants.ShowPhoto,NectarPhotosLog.showPhotoHandler);});onbeforeunloadRegister(function(){NectarPhotosLog.flushLog();},false);\nfunction PageCache(a,b){if(this===window)return new PageCache(a,b);this._MAX_PAGE_NUM=typeof a=='undefined'?5:a;this._MAX_TTL=typeof b=='undefined'?600000:b;this._storage=new CacheStorage();}copy_properties(PageCache.prototype,{_normalizeURI:function(a){a=new URI(a);if(a.getPath()=='\/')a.setPath('\/home.php');return a.getUnqualifiedURI().setFragment('').removeQueryData('ref').toString();},addPage:function(c,b){c=this._normalizeURI(c);var a=this._storage.get(c,{});a.normalized_uri=new URI(c);copy_properties(a,b);a.accessTime=a.genTime=(new Date()).getTime();this._clearCache();},updatePage:function(c,a){c=this._normalizeURI(c);var b=this._storage.get(c);if(typeof b==='undefined')return;copy_properties(b,a);this._storage.set(c,b);},isPageInCache:function(b){var a=this._storage.get(this._normalizeURI(b));return (typeof a!=='undefined');},invalidatePage:function(a){a=this._normalizeURI(a);this._storage.remove(a);},getPage:function(b){this._clearCache();b=this._normalizeURI(b);var a=this._storage.get(b);if(typeof a==='undefined')return null;a.accessTime=(new Date()).getTime();return a;},_clearCache:function(){var b=(new Date()).getTime();var d=null;var f=0;var a=this._storage.keys();for(var c=0;c<a.length;c++){var h=a[c];var e=this._storage.get(h);var g=e.ttl||this._MAX_TTL;if(e.genTime<b-g){this._storage.remove(h);continue;}if(!d||this._storage.get(d).accessTime>e.accessTime)d=h;f++;}if(f>this._MAX_PAGE_NUM&&d)this._storage.remove(d);}});\nvar Quickling={PAGECACHE_EXEC:'quickling\/pc',isActive:function(){return Quickling._is_active||false;},isFeatureEnabled:function(a){return Quickling._capabilities&&Quickling._capabilities[a];},init:function(c,b,a){if(Quickling._is_initialized)return;copy_properties(Quickling,{_is_initialized:true,_is_active:true,_session_length:b,_capabilities:a,_is_in_transition:false,_title_interval:false,_ie_cache_title:'',_cache_hit:false,_version:c});Quickling._instrumentTimeoutFunc('setInterval');Quickling._instrumentTimeoutFunc('setTimeout');PageTransitions.registerHandler(Quickling._transitionHandler,1);if(Quickling.isFeatureEnabled('page_cache')){Quickling._cache=new PageCache();Quickling._invalidate_msgs=[];Arbiter.subscribe(Arbiter.NEW_NOTIFICATIONS,Quickling._onNotifications);Arbiter.subscribe(AsyncRequest.REPLAYABLE_AJAX,Quickling._onReplayableAjax);Arbiter.subscribe(Arbiter.PAGECACHE_INVALIDATE,Quickling._onCacheInvalidates);}if(!Quickling.isFeatureEnabled('domain_rewrite'))PageTransitions._rewriteSubDomain=PageTransitions._revertSubDomain=function(d){return d;};},_onNotifications:function(b,a){Quickling._cache=new PageCache();Quickling._invalidate_msgs=[];},_onCacheInvalidates:function(c,b){if(Quickling.isFeatureEnabled('page_cache')&&b&&b.length){for(var a=0;a<b.length;a++)if(parseInt(b[a])===0){if(Quickling._is_in_transition&&!Quickling.isFeatureEnabled('flush_cache_in_transition'))break;if(Quickling._cache.isPageInCache(PageTransitions.getMostRecentURI())&&!Quickling.isFeatureEnabled('flush_cache_in_page_write'))break;Quickling._cache=new PageCache();Quickling._invalidate_msgs=[];return;}Quickling._invalidate_msgs=Quickling._invalidate_msgs.concat(b);}},_refresh_pagelets:function(){if(is_empty(window.__listeners))return;for(var a=0;a<Quickling._invalidate_msgs.length;a++){var b=Quickling._invalidate_msgs[a];if(b in window.__listeners)window.__listeners[b].forEach(function(c){c.refresh();});}},registerPageCacheHook:function(a,c){if(!Quickling._is_initialized||!Quickling._is_active||Quickling._is_in_transition||!Quickling.isFeatureEnabled('page_cache'))return;var b=PageTransitions.getMostRecentURI();var e=Quickling._cache.getPage(b);if(e){if(c)for(var d=0;d<e.replays.length;d++)if(e.replays[d][0]==c){e.replays.splice(d,1);d--;}e.replays.push([c,a]);}},_onReplayableAjax:function(c,b){if((PageTransitions.getNextURI().toString()!=PageTransitions.getMostRecentURI().toString()))return;if(Quickling._is_in_transition)return;var a=Quickling._whitelist_regex;if(!a)a=Quickling._whitelist_regex=new RegExp(env_get('pagecache_whitelist_regex'));if(a.test(URI(b.getURI()).getPath()))return;Quickling.registerPageCacheHook(bind(b,b.replayResponse),b._replayKey);},_startQuicklingTransition:function(){Quickling._is_in_transition=true;window.channelManager&&window.channelManager.setActionRequest(true);},_stopQuicklingTransition:function(){(function(){Quickling._is_in_transition=false;}).defer();},isCacheHit:function(){return Quickling._cache_hit;},goHashOrGoHere:function(d){var c=URI.getRequestURI();var b=c.getFragment();if(b.startsWith('\/')){var a=b;}else var a=d;setTimeout(function(){PageTransitions.go(a,true);},0);},isPageActive:function(d){if(d=='#')return false;d=new URI(d);if(d.getDomain()&&d.getDomain()!=URI().getDomain())return false;var b=Quickling.isPageActive.regex;if(!b)b=Quickling.isPageActive.regex=new RegExp(env_get('quickling_inactive_page_regex'));if(!Quickling.isFeatureEnabled('full_platform')){query=d.getQueryData();if(query._fb_qsub&&query._fb_qsub.startsWith('apps'))if(!query['_fb_q'])return false;}var c=d.getPath();var a=d.getQueryData();if(a)c+='?'+URI.implodeQuery(a);if(b.test(c))return false;return true;},_setHTML:function(a,b){if(ua.ie()<=6){a.innerHTML=b;}else DOM.setContent(a,HTML(b).setDeferred(true));},_transitionHandler:function(i){Quickling.current_request=null;if(Quickling._isTimeToRefresh())return false;if(!Quickling.isPageActive(i))return false;i=PageTransitions._revertSubDomain(i);removeHook('onafterloadhooks');removeHook('onloadhooks');_runHooks('onleavehooks');window.ExitTime=(new Date()).getTime();Quickling._startQuicklingTransition();$('content').style.visibility=\"visible\";var f;if(Quickling.isFeatureEnabled('page_cache')&&(f=Quickling._cache.getPage(PageTransitions.getMostRecentURI()))){invoke_callbacks(f.onpagecache);f.incremental_updates=AsyncRequest.stashBundledRequest();window.ads_refreshing=false;}if(Quickling.isFeatureEnabled('page_cache')&&(f=Quickling._cache.getPage(i))){var e=null;var b={};b[Quickling.PAGECACHE_EXEC]=2;var a=new Arbiter();a.registerCallback(function(){$('content').style.visibility=\"visible\";if(Quickling.current_request!==e)return;if(e&&e.cavalry){e.cavalry.setTimeStamp('t_domcontent');e.cavalry.setTimeStamp('t_hooks');e.cavalry.setTimeStamp('t_layout');e.cavalry.setTimeStamp('t_onload');}Quickling._cache_hit=true;invoke_callbacks(f.onafterload);invoke_callbacks(f.onafterpagecache);Quickling._cache_hit=false;Quickling._stopQuicklingTransition();},b);e=Quickling.current_request=AsyncRequest.setBundledRequestProperties({stashedRequests:f.incremental_updates,callback:function(){if(e&&e.cavalry)e.cavalry&&e.cavalry.setTimeStamp('t_html');a.inform(Quickling.PAGECACHE_EXEC,true,Arbiter.BEHAVIOR_EVENT);},onInitialResponse:Quickling._onInitialResponse,extra_data:{uri:f.normalized_uri.getQualifiedURI().toString(),version:Quickling._version},start_immediately:true});Quickling._preBootloadHandler();Bootloader.loadResources(f.css.concat(f.js),null,true);Quickling._changePageTitle(f.title);Quickling._replaceSyndicationLinks(f.syndication_links||[]);var c=f.body_class||'';CSS.setClass(document.body,c+(CSS.hasClass(document.body,'chat_body')?' chat_body':''));var d=$('content');d.style.visibility=\"hidden\";f.html=f.html.replace(\/<span class=[\"']?muffin_tracking_pixel_start[\"']?><\\\/span>.*?<span class=[\"']?muffin_tracking_pixel_end[\"']?><\\\/span>\/ig,'');Quickling._setHTML(d,f.html);if(d&&d.style.height=='1234px')d.style.height='';PageTransitions.transitionComplete();Quickling._cache_hit=true;invoke_callbacks(f.onload);Quickling._cache_hit=false;Quickling._refresh_pagelets();f.replays.forEach(function(j){j[1]();});PageTransitions.restoreScrollPosition();a.inform(Quickling.PAGECACHE_EXEC,true,Arbiter.BEHAVIOR_EVENT);}else{var g={version:Quickling._version};i=new URI(i).addQueryData({quickling:g});var h=new AsyncRequest();Quickling.current_request=h;h.quickling_arbiter=new Arbiter();h.setPreBootloadHandler(Quickling._preBootloadHandler).setInitialHandler(Quickling._onInitialResponse).setHandler(Quickling._onresponse).setMethod('GET').setReadOnly(true).setOption('useIframeTransport',true).setURI(i).send();}return true;},_preBootloadHandler:function(g){if(g&&!g.getPayload().redirect){var e=g.getPayload();var f=g.getRequest();if(!f||!f.quickling_arbiter)return false;if(f!=Quickling.current_request)return false;var a=f.quickling_arbiter;if(Quickling.isFeatureEnabled('page_cache'))if(g.is_first&&e.page_cache_ttl)Quickling.cacheResponse(g);g.payload.css=g.css||[];g.payload.js=g.js||[];g.css=g.js=null;if(g.is_first){var c=function(){f.cavalry&&f.cavalry.setTimeStamp('t_domcontent');Quickling._stopQuicklingTransition();PageTransitions.transitionComplete();a.inform(OnloadEvent.ONLOAD_DOMCONTENT_CALLBACK,true,Arbiter.BEHAVIOR_STATE);};var d=function(){if(f.cavalry){f.cavalry.setTimeStamp('t_hooks');f.cavalry.setTimeStamp('t_layout');f.cavalry.setTimeStamp('t_onload');}a.inform(OnloadEvent.ONLOAD_CALLBACK,true,Arbiter.BEHAVIOR_STATE);};f.pipe=new BigPipe(a,g.payload.num_phases,g.payload.phase_timeout,f.cavalry,true,c,d);}if(!g.is_first)return false;}var b=ge('content');if(b){b.style.height='1234px';DOM.empty(b);}DOMScroll.scrollTo(new Vector2(0,0,'document'),false);return g&&!g.getPayload().redirect;},_onInitialResponse:function(d){var a=d.getPayload();var c=d.getRequest();if(c!=Quickling.current_request)return false;if(!a)return true;if(a.redirect){var b=PageTransitions._rewriteSubDomain(a.redirect);if(a.force||!Quickling.isPageActive(b)){go_or_replace(window.location,URI(a.redirect).removeQueryData('quickling'),true);}else PageTransitions.go(b,true);return false;}if(a.version&&a.version!=Quickling._version){go_or_replace(window.location,URI(a.uri).removeQueryData('quickling'),true);return false;}return true;},_changePageTitle:function(a){a=a||'Facebook';document.title=a;if(ua.ie()){Quickling._ie_cache_title=a;if(!Quickling._title_interval)Quickling._title_interval=window.setInterval(function(){var b=Quickling._ie_cache_title;var c=document.title;if(b!=c)document.title=b;},5000,false);}},_replaceSyndicationLinks:function(d){var c=document.getElementsByTagName('link');for(var b=0;b<c.length;++b){if(c[b].rel!='alternate')continue;DOM.remove(c[b]);}if(d.length){var a=DOM.find(document,'head');a&&DOM.appendContent(a,HTML(d[0]));}},cacheResponse:function(c,a){var b=c.payload;Quickling._cache.addPage(PageTransitions.getNextURI(),{title:b.title,syndication:b.syndication||[],body_class:b.body_class,html:b.content.content,js:c.js||[],css:c.css||[],onload:c.onload||[],onafterload:c.onafterload||[],onpagecache:b.onpagecache||[],onafterpagecache:b.onafterpagecache||[],ttl:b.page_cache_ttl,replays:[]});if(a){invoke_callbacks(c.onload);onafterloadRegister(function(){invoke_callbacks(c.onafterload);});}},cacheAndExecResponse:function(c,d){var a=PageTransitions.getNextURI();var b=Quickling._cache.getPage(a);if(b){if(c.html)b.html=c.html;b.js=b.js.concat(c.js||[]);b.css=b.css.concat(c.css||[]);b.onload=b.onload.concat(c.onload||[]);b.onafterload=b.onafterload.concat(c.onafterload||[]);b.onpagecache=b.onpagecache.concat(c.onpagecache||[]);b.onafterpagecache=b.onafterpagecache.concat(c.onafterpagecache||[]);}if(!d){invoke_callbacks(c.onload);onafterloadRegister(function(){invoke_callbacks(c.onafterload);});}},_onresponse:function(f){var d=f.payload;var e=f.getRequest();if(!e||!e.quickling_arbiter)return AsyncRequest.suppressOnloadToken;if(e!=Quickling.current_request)return AsyncRequest.suppressOnloadToken;var a=e.quickling_arbiter;if(f.is_first){Quickling._changePageTitle(d.title);Quickling._replaceSyndicationLinks(d.syndication||[]);var b=d.body_class||'';CSS.setClass(document.body,b+(CSS.hasClass(document.body,'chat_body')?' chat_body':''));if(d.hasOnbeforeshow)$('content').style.visibility='hidden';d.provides.push('uipage_onload');}if(!f.is_last||f.is_first){d.onload=f.onload;d.onafterload=f.onafterload;e.pipe.onPageletArrive(d);}if(f.is_last){var c=ge('content');if(c&&c.style.height=='1234px')c.style.height='';e.cavalry&&e.cavalry.setTimeStamp('t_html');}return AsyncRequest.suppressOnloadToken;},_isTimeToRefresh:function(){Quickling._load_count=(Quickling._load_count||0)+1;return Quickling._load_count>=Quickling._session_length;},_instrumentTimeoutFunc:function(a){window[a+'_native']=(function(c){var b=function b(e,d){return c(e,d);};return b;})(window[a]);window[a]=function _setTimeout(d,c,b){var e=window[a+'_native'](d,c);if(c>0)onunloadRegister(function(){clearInterval(e);},b);return e;};}};function onpagecacheRegister(a,b){b=(b===undefined?'':String(b));Quickling.registerPageCacheHook(a,b);}\nfunction Task(a,b){copy_properties(this,{task:a,option:{synchronous:!!b},status:Task.WAITING,result:null,queue:null});}copy_properties(Task,{WAITING:0,READY:1,RUNNING:2,DONE:3,ERROR:4});copy_properties(Task.prototype,Configurable);copy_properties(Task.prototype,{run:function(){this.status=Task.RUNNING;try{var a=this.task();}catch(exception){this.status=Task.ERROR;exception._task=this;throw exception;}if(this.getOption('synchronous'))this.didComplete(a);},didComplete:function(a){this.result=a;this.status=Task.DONE;if(this.queue)this.queue.didCompleteTask(this);return this;}});function TaskQueue(){copy_properties(this,{queue:[],executingTasks:0,executionDepth:0,option:{synchronous:true,concurrency:2}});}copy_properties(TaskQueue.prototype,Configurable);copy_properties(TaskQueue.prototype,{addTask:function(a){this.queue.push(a);a.queue=this;return a;},didCompleteTask:function(a){this.executingTasks--;this.reapQueue();if(!this.executionDepth)this.start();},runTask:function(a){this.executingTasks++;if(this.getOption('synchronous')){try{a.run();}catch(exception){this.didCompleteTask();}}else setTimeout(bind(a,'run'),10);},reapQueue:function(){var c;var a,b;for(a=0,b=this.queue.length;a<b;a++){c=this.queue[a].status;if(c!=Task.DONE&&c!=Task.ERROR)break;}if(a)this.queue=this.queue.slice(a);},start:function(){this.executionDepth++;while(this.executingTasks<this.getOption('concurrency')){for(var a=0,b=this.queue.length;a<b;a++)if(this.queue[a].status==Task.READY){this.runTask(this.queue[a]);break;}if(a==b)break;}this.executionDepth--;},ready:function(c){c=c||1;for(var a=0,b=this.queue.length;a<b;a++)if(this.queue[a].status==Task.WAITING){this.queue[a].status=Task.READY;if(!(--c))break;}this.start();}});\nfunction photo_remove_profile_picture(a){function b(){var c=new AsyncRequest().setURI('\/ajax\/profile\/picture\/remove.php').setData({remove:true,id:a}).setHandler(bind(document.location,document.location.reload)).send();}new Dialog().setTitle(_tx(\"Remove Picture?\")).setBody(_tx(\"Are you sure you want to remove this picture?\")).setButtons(Dialog.OK_AND_CANCEL).setHandler(b).show();return false;}\n\nif (window.Bootloader) { Bootloader.done([\"js\\\/aw0s0mjm7jksksg0.pkg.js\"]); }")